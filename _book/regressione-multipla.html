<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capitolo 2 Regressione multipla | PSICOMETRIA</title>
<meta name="author" content="Corrado Caudek">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">PSICOMETRIA</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Benvenuti</a></li>
<li><a class="" href="una-breve-introduzione-al-modello-di-regressione.html"><span class="header-section-number">1</span> Una breve introduzione al modello di regressione</a></li>
<li><a class="active" href="regressione-multipla.html"><span class="header-section-number">2</span> Regressione multipla</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="regressione-multipla" class="section level1" number="2">
<h1>
<span class="header-section-number">Capitolo 2</span> Regressione multipla<a class="anchor" aria-label="anchor" href="#regressione-multipla"><i class="fas fa-link"></i></a>
</h1>
<div id="assenza-di-interazione" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Assenza di interazione<a class="anchor" aria-label="anchor" href="#assenza-di-interazione"><i class="fas fa-link"></i></a>
</h2>
<p>Esaminiamo ora i dati <code>epi.bfi</code> contenuti nel pacchetto <code>psychTools</code> che contengono 231 osservazioni relative a 5 scale dall’Eysenck Personality Inventory, 5 scale del Big 5, i valori del Beck Depression Inventory e misure di ansia di stato e ansia di tratto.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://strengejacke.github.io/sjPlot/">"sjPlot"</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://strengejacke.github.io/sjmisc/">"sjmisc"</a></span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/">"psychTools"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">epi.bfi</span><span class="op">)</span>
<span class="fu">glimpse</span><span class="op">(</span><span class="va">epi.bfi</span><span class="op">)</span>
<span class="co">#&gt; Rows: 231</span>
<span class="co">#&gt; Columns: 13</span>
<span class="co">#&gt; $ epiE     &lt;int&gt; 18, 16, 6, 12, 14, 6, 15, 18, 15, 8, 13, 14, 15, 19, 15, 11,…</span>
<span class="co">#&gt; $ epiS     &lt;int&gt; 10, 8, 1, 6, 6, 4, 9, 9, 11, 5, 9, 12, 10, 11, 10, 5, 10, 11…</span>
<span class="co">#&gt; $ epiImp   &lt;int&gt; 7, 5, 3, 4, 5, 2, 4, 7, 3, 2, 3, 3, 4, 7, 4, 6, 5, 6, 2, 4, …</span>
<span class="co">#&gt; $ epilie   &lt;int&gt; 3, 1, 2, 3, 3, 5, 3, 2, 3, 2, 3, 6, 5, 0, 2, 7, 0, 4, 1, 4, …</span>
<span class="co">#&gt; $ epiNeur  &lt;int&gt; 9, 12, 5, 15, 2, 15, 12, 10, 1, 10, 9, 1, 2, 3, 7, 13, 18, 1…</span>
<span class="co">#&gt; $ bfagree  &lt;int&gt; 138, 101, 143, 104, 115, 110, 109, 92, 127, 74, 124, 131, 13…</span>
<span class="co">#&gt; $ bfcon    &lt;int&gt; 96, 99, 118, 106, 102, 113, 58, 57, 108, 100, 114, 107, 114,…</span>
<span class="co">#&gt; $ bfext    &lt;int&gt; 141, 107, 38, 64, 103, 61, 99, 94, 108, 61, 100, 99, 114, 13…</span>
<span class="co">#&gt; $ bfneur   &lt;int&gt; 51, 116, 68, 114, 86, 54, 55, 72, 35, 87, 110, 92, 56, 47, 6…</span>
<span class="co">#&gt; $ bfopen   &lt;int&gt; 138, 132, 90, 101, 118, 149, 110, 114, 86, 89, 129, 121, 131…</span>
<span class="co">#&gt; $ bdi      &lt;int&gt; 1, 7, 4, 8, 8, 5, 7, 0, 0, 7, 8, 3, 0, 0, 1, 4, 14, 7, 9, 4,…</span>
<span class="co">#&gt; $ traitanx &lt;int&gt; 24, 41, 37, 54, 39, 51, 40, 32, 22, 35, 43, 33, 23, 23, 27, …</span>
<span class="co">#&gt; $ stateanx &lt;int&gt; 22, 40, 44, 40, 67, 38, 32, 41, 26, 31, 39, 25, 32, 23, 28, …</span></code></pre></div>
<p>Supponiamo di chiederi se c’è una relazione tra la depressione (<code>bdi</code>), considerata quale variabile dipendente, e Neuroticismo e ansia di stato. Considereremo in seguito il problema della possibile interazione tra Neuroticismo e ansia di stato. Per ora, scriviamo il modello di regressione nel modo seguente:</p>
<p><span class="math display">\[\begin{equation}
y = \alpha + \beta_1 x_1 + \beta_2 x_2 + \varepsilon.
\end{equation}\]</span></p>
<p>Abbiamo visto in precedenza come si interpretano i coefficienti di regressione nel caso della regressione bivariata. I coefficienti di regressione, detti <em>parziali</em>, che fanno parte del modello di regressione multipla hanno però un significato diverso da quello descritto in precedenza. Poniamoci dunque il problema di capire qual è la differenza tra un coefficiente di regressione (nel modello bivariato) e un coefficiente <em>parziale</em> di regressione (nel modello di regressione multipla).</p>
<p>In precedenza abbiamo visto che il coefficiente di regressione <span class="math inline">\(\beta\)</span> ha il seguente significato: indica la variazione del valore atteso della <span class="math inline">\(y\)</span> in base al modello lineare nel caso di un cambiamento unitario della <span class="math inline">\(x\)</span>. Ma adesso questa spiegazione non basta, in quanto nel modello di regressione multipla non c’è una sola variabile indipendente: nel caso considerato qui ce ne sono due. Dunque, qual è il significato di <span class="math inline">\(\beta_1\)</span> e di <span class="math inline">\(\beta_2\)</span>?</p>
<p>La risposta è che un generico <span class="math inline">\(\beta_j\)</span> nel modello di regressione multipla rappresenta la variazione del valore atteso della <span class="math inline">\(y\)</span> in base al modello lineare nel caso di un cambiamento unitario di <span class="math inline">\(x_j\)</span> <strong>al netto dell’effetto (lineare) di tutte le altre variabili <span class="math inline">\(x\)</span> incluse nel modello</strong>.</p>
<p>La seconda parte dell’affermazione precedente (“al netto di…”) è ciò che dobbiamo capire.</p>
<p>Iniziamo a calcolare con R i coefficienti parziali del modello di regressione multipla descritto sopra:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bdi</span> <span class="op">~</span> <span class="va">bfneur</span> <span class="op">+</span> <span class="va">stateanx</span>, data <span class="op">=</span> <span class="va">epi.bfi</span><span class="op">)</span></code></pre></div>
<p>I coefficienti parziali di regressione sono:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt; (Intercept)      bfneur    stateanx </span>
<span class="co">#&gt;      -8.039       0.054       0.252</span></code></pre></div>
<p>Iniziamo a considerare il coefficiente parziale associato a Neuroticismo. Il valore <span class="math inline">\(\beta_1\)</span> = 0.054 ci dice che ci aspettiamo che il valore di depressione aumenti in media di <span class="math inline">\(\beta_1\)</span> = 0.054 punti quando il livello di Neuroticismo aumenta di un punto e il livello di ansia di stato viene mantenuto costante.</p>
<p>Ma che vuol dire “mantenere costante” il livello di ansia di stato? Questo è un esempio di <em>controllo statistico</em> e può essere spiegato nel modo seguente.</p>
<p>Abbiamo visto in precedenza che il modello lineare scompone la <span class="math inline">\(y\)</span> in due componenti: la componente predicibile da <span class="math inline">\(x\)</span> e la componente della <span class="math inline">\(y\)</span> che un modello lineare non può prevedere.</p>
<p>Scomponiamo dunque i valori <code>bdi</code> in due componenti: la quota del <code>bdi</code> che l’ansia di stato può prevedere (con un modello lineare) e la quota del <code>bdi</code> che l’ansia di stato non può prevedere. Tale seconda componente di <code>bdi</code> è data dai residui (<span class="math inline">\(\varepsilon\)</span>) del seguente modello di regressione:</p>
<p><span class="math display">\[\begin{equation}
\text{bdi} = \alpha + \beta \text{stateanx} + \varepsilon.
\end{equation}\]</span></p>
<p>Usando R, tali residui sono dati da:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bdi</span> <span class="op">~</span> <span class="va">stateanx</span>, data <span class="op">=</span> <span class="va">epi.bfi</span><span class="op">)</span>
<span class="va">m1</span><span class="op">$</span><span class="va">res</span>
<span class="co">#&gt;            1            2            3            4            5            6 </span>
<span class="co">#&gt;  -0.31513580   0.17439480  -4.05015396   1.17439480  -7.09130931  -1.21333082 </span>
<span class="co">#&gt;            7            8            9           10           11           12 </span>
<span class="co">#&gt;   2.62349231  -7.13174239  -2.53968455   2.92962950   1.48053199   0.76645264 </span>
<span class="co">#&gt;           13           14           15           16           17           18 </span>
<span class="co">#&gt;  -4.37650769  -1.62127299  -2.15195893   0.84804107   2.27619977  -1.05015396 </span>
<span class="co">#&gt;           19           20           21           22           23           24 </span>
<span class="co">#&gt;  -2.72380023  -1.29491926  -2.15195893   2.03143447  -6.74401677   1.56212042 </span>
<span class="co">#&gt;           25           26           27           28           29           30 </span>
<span class="co">#&gt;   1.62349231   3.78666918  -3.60105645  -5.13174239   1.56212042   2.09280637 </span>
<span class="co">#&gt;           31           32           33           34           35           36 </span>
<span class="co">#&gt;  -9.19311428   3.74551383   1.84804107   0.70508074   3.62349231  -2.88697709 </span>
<span class="co">#&gt;           37           38           39           40           41           42 </span>
<span class="co">#&gt;  -1.21333082   3.01121793  -1.84582174   9.86825761  -4.35629115  -3.45809612 </span>
<span class="co">#&gt;           43           44           45           46           47           48 </span>
<span class="co">#&gt;   1.07258982   4.84804107  -5.43787958  -0.88697709   4.43937664   2.88847415 </span>
<span class="co">#&gt;           49           50           51           52           53           54 </span>
<span class="co">#&gt;   2.19461134  -2.07037050   4.62349231   5.39894355   0.31735512  -3.49925147 </span>
<span class="co">#&gt;           55           56           57           58           59           60 </span>
<span class="co">#&gt;  -0.84582174  -1.23354736   3.23576669  -0.84582174   2.54190388  -1.43787958 </span>
<span class="co">#&gt;           61           62           63           64           65           66 </span>
<span class="co">#&gt;  -5.82560520   2.07258982   7.19461134  -2.51946801  -1.07037050  12.58233696 </span>
<span class="co">#&gt;           67           68           69           70           71           72 </span>
<span class="co">#&gt;  -1.74401677   0.62349231  -5.60105645   0.33757166   1.80688572   7.15417826 </span>
<span class="co">#&gt;           73           74           75           76           77           78 </span>
<span class="co">#&gt;  -1.84582174   0.15417826  -1.37650769  11.60255350  -5.25448617  -0.43787958 </span>
<span class="co">#&gt;           79           80           81           82           83           84 </span>
<span class="co">#&gt;   2.74551383  -0.82560520  -3.82560520  11.01121793  -0.53968455   8.01121793 </span>
<span class="co">#&gt;           85           86           87           88           89           90 </span>
<span class="co">#&gt;  -2.84582174  -4.29491926   0.17439480  -1.37650769   7.13323945  -4.74401677 </span>
<span class="co">#&gt;           91           92           93           94           95           96 </span>
<span class="co">#&gt;   8.15417826  -0.60105645  12.72529728  -1.80538866  -2.82560520   7.23504442 </span>
<span class="co">#&gt;           97           98           99          100          101          102 </span>
<span class="co">#&gt;   2.88847415  -6.00972088  -5.70358369   0.46031545   2.09280637  -9.02993742 </span>
<span class="co">#&gt;          103          104          105          106          107          108 </span>
<span class="co">#&gt;  -3.90719363  -6.72380023  -5.72380023   0.31735512   4.33757166  -1.68264488 </span>
<span class="co">#&gt;          109          110          111          112          113          114 </span>
<span class="co">#&gt;  -3.45809612  -3.98878207  -5.74401677  -2.29491926  -0.53968455  -2.29491926 </span>
<span class="co">#&gt;          115          116          117          118          119          120 </span>
<span class="co">#&gt;  -0.21333082  -4.51946801  -1.98878207  -1.31513580   0.76645264  -1.35629115 </span>
<span class="co">#&gt;          121          122          123          124          125          126 </span>
<span class="co">#&gt;   0.92962950   1.58233696  -4.13174239   3.84804107   1.37872701  -1.76423331 </span>
<span class="co">#&gt;          127          128          129          130          131          132 </span>
<span class="co">#&gt;  -2.35629115  -7.11152585  -0.84582174  -0.98878207   9.05165101  -2.51946801 </span>
<span class="co">#&gt;          133          134          135          136          137          138 </span>
<span class="co">#&gt;  -3.37650769  -2.37650769  -1.37650769  -3.51946801  -1.27470272  10.58233696 </span>
<span class="co">#&gt;          139          140          141          142          143          144 </span>
<span class="co">#&gt;  -6.51946801  -1.60105645   7.17439480  -2.49925147  -3.21333082   1.94984604 </span>
<span class="co">#&gt;          145          146          147          148          149          150 </span>
<span class="co">#&gt;   0.17439480  -3.27470272  -7.78517212  -0.05015396   7.48053199  -4.11152585 </span>
<span class="co">#&gt;          151          152          153          154          155          156 </span>
<span class="co">#&gt;  -5.60105645  -1.62127299  -5.88697709   1.94984604   2.03143447   0.31735512 </span>
<span class="co">#&gt;          157          158          159          160          161          162 </span>
<span class="co">#&gt;   5.92962950  -2.41766304  -1.35629115   2.64370885   8.46031545  -4.70358369 </span>
<span class="co">#&gt;          163          164          165          166          167          168 </span>
<span class="co">#&gt;   0.84804107   1.31735512  -4.80538866  -2.41766304   1.17439480   0.92962950 </span>
<span class="co">#&gt;          169          170          171          172          173          174 </span>
<span class="co">#&gt;   1.15417826   3.72529728  -0.51946801   1.48053199   5.35778820  -1.43787958 </span>
<span class="co">#&gt;          175          176          177          178          179          180 </span>
<span class="co">#&gt;  -0.45809612   2.37872701  -3.13174239  12.09280637   1.48053199  -3.68264488 </span>
<span class="co">#&gt;          181          182          183          184          185          186 </span>
<span class="co">#&gt;  -4.68264488   0.52096507  -0.27470272  -0.68264488  -2.37650769  -1.92741018 </span>
<span class="co">#&gt;          187          188          189          190          191          192 </span>
<span class="co">#&gt;   4.37872701  10.97006258   1.78666918  -2.15195893  -1.60105645   6.01121793 </span>
<span class="co">#&gt;          193          194          195          196          197          198 </span>
<span class="co">#&gt;   1.31735512  -4.25448617 -11.11152585   2.58233696   2.23576669  -6.05015396 </span>
<span class="co">#&gt;          199          200          201          202          203          204 </span>
<span class="co">#&gt;  -4.94834899  -3.15195893   2.76645264  -2.37650769   2.56212042  -2.98878207 </span>
<span class="co">#&gt;          205          206          207          208          209          210 </span>
<span class="co">#&gt;   0.01121793  -0.84582174  11.50074853   3.01121793   7.78666918  -7.43787958 </span>
<span class="co">#&gt;          211          212          213          214          215          216 </span>
<span class="co">#&gt;  15.11302291   0.99100139  -4.21333082   6.25598323  -3.51946801  -3.98878207 </span>
<span class="co">#&gt;          217          218          219          220          221          222 </span>
<span class="co">#&gt;   4.09280637  -4.07037050  -3.66242834  -4.37650769   1.01121793   8.19461134 </span>
<span class="co">#&gt;          223          224          225          226          227          228 </span>
<span class="co">#&gt;   6.33757166  -2.53968455   0.39894355   3.54190388  -1.82560520   4.01121793 </span>
<span class="co">#&gt;          229          230          231 </span>
<span class="co">#&gt;  -7.96856553  -7.33607461  11.66392539</span></code></pre></div>
<p>Eseguiamo una scomposizione simile per i valori di Neuroticismo: troviamo la quota di <code>bfneur</code> che l’ansia di stato può prevedere e la quota di <code>bfneur</code> che l’ansia di stato non può prevedere. Tale seconda componente di <code>bfneur</code> è data dai residui del seguente modello di regressione:</p>
<p><span class="math display">\[\begin{equation}
\text{bfneur} = \alpha + \beta \text{stateanx} + \varepsilon.
\end{equation}\]</span></p>
<p>Usando R, tali residui sono dati da:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bfneur</span> <span class="op">~</span> <span class="va">stateanx</span>, data <span class="op">=</span> <span class="va">epi.bfi</span><span class="op">)</span>
<span class="va">m2</span><span class="op">$</span><span class="va">res</span>
<span class="co">#&gt;           1           2           3           4           5           6 </span>
<span class="co">#&gt; -19.1234231  27.8788066 -24.1206979  25.8788066 -29.1178487 -32.1214411 </span>
<span class="co">#&gt;           7           8           9          10          11          12 </span>
<span class="co">#&gt; -25.1221843 -17.1210695 -39.1229276   7.8776918  22.8786828  18.8769485 </span>
<span class="co">#&gt;          13          14          15          16          17          18 </span>
<span class="co">#&gt; -24.1221843 -24.1232992 -14.1226798   6.8773202   1.8807886 -20.1206979 </span>
<span class="co">#&gt;          19          20          21          22          23          24 </span>
<span class="co">#&gt; -20.1192114  -7.1218127  -5.1226798 -21.1203262  -4.1208217   3.8790544 </span>
<span class="co">#&gt;          25          26          27          28          29          30 </span>
<span class="co">#&gt;  27.8778157  -7.1214411 -23.1216889 -19.1210695 -22.1209456   5.8784350 </span>
<span class="co">#&gt;          31          32          33          34          35          36 </span>
<span class="co">#&gt; -22.1198307  -9.1185920  -6.1226798  23.8781873 -26.1221843   3.8800454 </span>
<span class="co">#&gt;          37          38          39          40          41          42 </span>
<span class="co">#&gt; -10.1214411 -22.1219366  -3.1228037  -8.1210695  -8.1205740 -17.1225560 </span>
<span class="co">#&gt;          43          44          45          46          47          48 </span>
<span class="co">#&gt;  -9.1231753  42.8773202  -5.1209456  -0.1199546  -5.1184681 -23.1194591 </span>
<span class="co">#&gt;          49          50          51          52          53          54 </span>
<span class="co">#&gt;  26.8804170  -3.1223082   6.8778157  10.8783111  21.8779395 -16.1197069 </span>
<span class="co">#&gt;          55          56          57          58          59          60 </span>
<span class="co">#&gt; -27.1228037 -13.1230515   4.8775679  30.8771963  12.8774440 -29.1209456 </span>
<span class="co">#&gt;          61          62          63          64          65          66 </span>
<span class="co">#&gt; -36.1211934 -20.1231753 -29.1195830  -6.1213172 -16.1223082 -18.1193352 </span>
<span class="co">#&gt;          67          68          69          70          71          72 </span>
<span class="co">#&gt; -29.1208217 -10.1221843  49.8783111   4.8795499  10.8801693  29.8771963 </span>
<span class="co">#&gt;          73          74          75          76          77          78 </span>
<span class="co">#&gt;   2.8771963 -25.1228037  -6.1221843  -4.1177249 -39.1185920   1.8790544 </span>
<span class="co">#&gt;          79          80          81          82          83          84 </span>
<span class="co">#&gt;   5.8814080  -7.1211934  12.8788066   1.8780634  -6.1229276 -21.1219366 </span>
<span class="co">#&gt;          85          86          87          88          89          90 </span>
<span class="co">#&gt; -33.1228037 -24.1218127  -6.1211934  15.8778157  -9.1183442 -15.1208217 </span>
<span class="co">#&gt;          91          92          93          94          95          96 </span>
<span class="co">#&gt; -41.1228037  12.8783111   1.8797976   6.8804170 -26.1211934  24.8836378 </span>
<span class="co">#&gt;          97          98          99         100         101         102 </span>
<span class="co">#&gt;  11.8805409   4.8825229 -17.1176010 -14.1229276 -17.1215650 -16.1190875 </span>
<span class="co">#&gt;         103         104         105         106         107         108 </span>
<span class="co">#&gt;   9.8784350  10.8807886 -33.1192114  18.8779395   3.8795499  -8.1220605 </span>
<span class="co">#&gt;         109         110         111         112         113         114 </span>
<span class="co">#&gt; -22.1225560 -21.1219366  12.8791783  10.8781873  -0.1229276   9.8781873 </span>
<span class="co">#&gt;         115         116         117         118         119         120 </span>
<span class="co">#&gt;  -1.1214411 -41.1213172 -21.1219366 -20.1234231 -22.1230515  22.8794260 </span>
<span class="co">#&gt;         121         122         123         124         125         126 </span>
<span class="co">#&gt; -29.1223082  -5.1193352  -6.1210695 -12.1226798 -21.1232992  19.8775679 </span>
<span class="co">#&gt;         127         128         129         130         131         132 </span>
<span class="co">#&gt;  10.8794260  -2.1194591 -11.1228037  10.8780634   0.8812841  22.8786828 </span>
<span class="co">#&gt;         133         134         135         136         137         138 </span>
<span class="co">#&gt;   3.8778157  -0.1221843 -29.1221843  14.8786828  10.8797976 -21.1193352 </span>
<span class="co">#&gt;         139         140         141         142         143         144 </span>
<span class="co">#&gt; -13.1213172 -14.1216889 -11.1211934   3.8802931 -19.1214411 -13.1206979 </span>
<span class="co">#&gt;         145         146         147         148         149         150 </span>
<span class="co">#&gt;  17.8788066   6.8797976 -38.1179726  -2.1206979 -10.1213172 -33.1194591 </span>
<span class="co">#&gt;         151         152         153         154         155         156 </span>
<span class="co">#&gt; -27.1216889 -18.1232992  -6.1199546 -21.1206979  21.8796738 -12.1220605 </span>
<span class="co">#&gt;         157         158         159         160         161         162 </span>
<span class="co">#&gt; -23.1223082 -23.1193352  -7.1205740   8.8794260  54.8770724  -0.1176010 </span>
<span class="co">#&gt;         163         164         165         166         167         168 </span>
<span class="co">#&gt;   1.8773202  18.8779395  10.8804170  24.8806648  14.8788066  29.8776918 </span>
<span class="co">#&gt;         169         170         171         172         173         174 </span>
<span class="co">#&gt;  25.8771963   7.8797976  -6.1213172  15.8786828   4.8811603  53.8790544 </span>
<span class="co">#&gt;         175         176         177         178         179         180 </span>
<span class="co">#&gt; -19.1225560  27.8767008  28.8789305  56.8784350  13.8786828  23.8779395 </span>
<span class="co">#&gt;         181         182         183         184         185         186 </span>
<span class="co">#&gt; -15.1220605  13.8819035  30.8797976   9.8779395  17.8778157  -9.1231753 </span>
<span class="co">#&gt;         187         188         189         190         191         192 </span>
<span class="co">#&gt;  26.8767008  19.8809125   6.8785589 -18.1226798   5.8783111  28.8780634 </span>
<span class="co">#&gt;         193         194         195         196         197         198 </span>
<span class="co">#&gt;  20.8779395 -18.1185920 -27.1194591   8.8806648  18.8775679  30.8793021 </span>
<span class="co">#&gt;         199         200         201         202         203         204 </span>
<span class="co">#&gt;  14.8812841 -29.1226798 -14.1230515  20.8778157  21.8790544  15.8780634 </span>
<span class="co">#&gt;         205         206         207         208         209         210 </span>
<span class="co">#&gt;  11.8780634   3.8771963  29.8802931  36.8780634   6.8785589  16.8790544 </span>
<span class="co">#&gt;         211         212         213         214         215         216 </span>
<span class="co">#&gt;  21.8800454  11.8764530  11.8785589  13.8791783  12.8786828  51.8780634 </span>
<span class="co">#&gt;         217         218         219         220         221         222 </span>
<span class="co">#&gt;  28.8784350 -14.1223082   9.8795499 -18.1221843  12.8780634  40.8804170 </span>
<span class="co">#&gt;         223         224         225         226         227         228 </span>
<span class="co">#&gt;   8.8795499  18.8770724  11.8783111   6.8774440  15.8788066   5.8780634 </span>
<span class="co">#&gt;         229         230         231 </span>
<span class="co">#&gt;   8.8796738  16.8810364  24.8810364</span></code></pre></div>
<p>Abbiamo così ottenuto la componente della variabile dipendente linermente indipendente da <code>stateanx</code> e la componente di <code>bfneur</code> linermente indipendente da <code>stateanx</code>. In altri termini, abbiamo “statisticamente controllato” l’effetto di <code>stateanx</code> su <code>bdi</code> e su <code>bfneur</code>. Se adesso vogliamo sapere qual è l’effetto di <code>bfneur</code> su <code>bdi</code>, indipendentemente dall’effetto di <code>stateanx</code> su entrambe le variabili, basta che eseguiamo l’analisi di regressione sulle componenti di <code>bdi</code> e <code>bfneur</code> che sono linearmente indipendenti da <code>stateanx</code>. Ovvero, dobbiamo calcolare il coefficiente <span class="math inline">\(b\)</span> del seguente modello di regressione:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">m1</span><span class="op">$</span><span class="va">res</span> <span class="op">~</span> <span class="va">m2</span><span class="op">$</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<p>Il coefficiente di regressione del modello precedente</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m3</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="co">#&gt;     m2$res </span>
<span class="co">#&gt; 0.05441396</span></code></pre></div>
<p>è identico al coefficiente <strong>parziale</strong> di regressione associato alla variabile <code>bfneur</code> nel modello di regressione multipla:ç</p>
<p><span class="math display">\[\begin{equation}
y = \alpha + \beta_1 x_1 + \beta_2 x_2 + \varepsilon.
\end{equation}\]</span></p>
<p>Ciò chiarisce il significato di “controllo statistico” e fa capire qual è la differenza tra il coefficiente di regressione del modello bivariato e il coefficiente parziale di regressione nel modello di regressione multipla.</p>
</div>
<div id="interazione-tra-i-regressori" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Interazione tra i regressori<a class="anchor" aria-label="anchor" href="#interazione-tra-i-regressori"><i class="fas fa-link"></i></a>
</h2>
<p>Stiamo considerando dunque il caso in cui vi sono due variabili indipendenti continue e il modello di regressione prevede la loro <code>interazione</code>. Cosa significa <code>interazione</code> tra le variabili indipendenti?</p>
<p>Per rispondeere a questa domanda utilizziamo dei nomi più semplici per le variabili e scriviamo il modello di regressione nel modo seguente:</p>
<p><span class="math display">\[\begin{equation}
y = \alpha + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 \times x_2 + \varepsilon.
\end{equation}\]</span></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">bdi</span> <span class="op">~</span> <span class="va">bfneur</span> <span class="op">*</span> <span class="va">stateanx</span>, data <span class="op">=</span> <span class="va">epi.bfi</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = bdi ~ bfneur * stateanx, data = epi.bfi)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -9.3273 -2.7107 -0.4746  1.9646 14.3104 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)  </span>
<span class="co">#&gt; (Intercept)      0.768518   3.763671   0.204   0.8384  </span>
<span class="co">#&gt; bfneur          -0.040827   0.040952  -0.997   0.3199  </span>
<span class="co">#&gt; stateanx         0.012673   0.100598   0.126   0.8999  </span>
<span class="co">#&gt; bfneur:stateanx  0.002501   0.001008   2.483   0.0138 *</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 4.416 on 227 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.4229, Adjusted R-squared:  0.4152 </span>
<span class="co">#&gt; F-statistic: 55.44 on 3 and 227 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://strengejacke.github.io/sjPlot/reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">m</span>, type <span class="op">=</span> <span class="st">"pred"</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bfneur"</span>, <span class="st">"stateanx"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="39_intro_reglin_files/figure-html/unnamed-chunk-34-1.png" width="90%" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="una-breve-introduzione-al-modello-di-regressione.html"><span class="header-section-number">1</span> Una breve introduzione al modello di regressione</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#regressione-multipla"><span class="header-section-number">2</span> Regressione multipla</a></li>
<li><a class="nav-link" href="#assenza-di-interazione"><span class="header-section-number">2.1</span> Assenza di interazione</a></li>
<li><a class="nav-link" href="#interazione-tra-i-regressori"><span class="header-section-number">2.2</span> Interazione tra i regressori</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>PSICOMETRIA</strong>" was written by Corrado Caudek. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
