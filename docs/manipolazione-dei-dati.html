<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capitolo 8 Manipolazione dei dati | Data Science per psicologi</title>
<meta name="author" content="Corrado Caudek">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Science per psicologi</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Benvenuti</a></li>
<li class="book-part">Obiettivi formativi</li>
<li><a class="" href="conoscenza-dichiarativa-e-imperativa.html"><span class="header-section-number">1</span> Conoscenza dichiarativa e imperativa</a></li>
<li class="book-part">Introduzione al linguaggio R</li>
<li><a class="" href="introduzione.html">Introduzione</a></li>
<li><a class="" href="chapter-pacchetti.html"><span class="header-section-number">2</span> Pacchetti</a></li>
<li><a class="" href="chapter-install-r.html"><span class="header-section-number">3</span> Per cominciare</a></li>
<li><a class="" href="chapter-sintassi.html"><span class="header-section-number">4</span> Sintassi di base</a></li>
<li><a class="" href="chapter-strutture-dati.html"><span class="header-section-number">5</span> Strutture di dati</a></li>
<li><a class="" href="chapter-strut-contr.html"><span class="header-section-number">6</span> Strutture di controllo</a></li>
<li><a class="" href="chapter-input-output.html"><span class="header-section-number">7</span> Input/Output</a></li>
<li><a class="active" href="manipolazione-dei-dati.html"><span class="header-section-number">8</span> Manipolazione dei dati</a></li>
<li><a class="" href="flusso-di-lavoro-riproducibile.html"><span class="header-section-number">9</span> Flusso di lavoro riproducibile</a></li>
<li class="book-part">Statistica descrittiva ed analisi esplorativa dei dat̀i</li>
<li><a class="" href="introduzione-1.html">Introduzione</a></li>
<li><a class="" href="terminologia.html"><span class="header-section-number">10</span> Terminologia</a></li>
<li><a class="" href="chapter-misurazione.html"><span class="header-section-number">11</span> La misurazione in psicologia</a></li>
<li><a class="" href="chapter-descript.html"><span class="header-section-number">12</span> Statistica descrittiva</a></li>
<li class="book-part">Nozioni di base</li>
<li><a class="" href="introduzione-2.html">Introduzione</a></li>
<li><a class="" href="il-calcolo-delle-probabilit%C3%A0.html"><span class="header-section-number">13</span> Il calcolo delle probabilità</a></li>
<li><a class="" href="chapter-prob-cond.html"><span class="header-section-number">14</span> Probabilità condizionata</a></li>
<li><a class="" href="chapter-teo-bayes.html"><span class="header-section-number">15</span> Il teorema di Bayes</a></li>
<li><a class="" href="chapter-prob-congiunta.html"><span class="header-section-number">16</span> Probabilità congiunta</a></li>
<li><a class="" href="la-distribuzione-binomiale.html"><span class="header-section-number">17</span> La distribuzione binomiale</a></li>
<li><a class="" href="funzioni-di-densit%C3%A0-di-probabilit%C3%A0.html"><span class="header-section-number">18</span> Funzioni di densità di probabilità</a></li>
<li><a class="" href="la-funzione-di-verosimiglianza.html"><span class="header-section-number">19</span> La funzione di verosimiglianza</a></li>
<li class="book-part">Inferenza frequentista</li>
<li><a class="" href="introduzione-3.html">Introduzione</a></li>
<li><a class="" href="distribuzione-campionaria.html"><span class="header-section-number">20</span> Distribuzione campionaria</a></li>
<li><a class="" href="significativit%C3%A0-statistica.html"><span class="header-section-number">21</span> Significatività statistica</a></li>
<li><a class="" href="inferenza-sulle-medie.html"><span class="header-section-number">22</span> Inferenza sulle medie</a></li>
<li><a class="" href="critiche-e-difese.html"><span class="header-section-number">23</span> Critiche e difese</a></li>
<li class="book-part">Inferenza Bayesiana</li>
<li><a class="" href="introduzione-4.html">Introduzione</a></li>
<li><a class="" href="modellistica-bayesiana.html"><span class="header-section-number">24</span> Modellistica Bayesiana</a></li>
<li><a class="" href="stima-della-funzione-a-posteriori.html"><span class="header-section-number">25</span> Stima della funzione a posteriori</a></li>
<li><a class="" href="sintesi-a-posteriori.html"><span class="header-section-number">26</span> Sintesi a posteriori</a></li>
<li><a class="" href="una-breve-introduzione-al-modello-di-regressione.html"><span class="header-section-number">27</span> Una breve introduzione al modello di regressione</a></li>
<li><a class="" href="il-modello-statistico-della-regressione-lineare.html"><span class="header-section-number">28</span> Il modello statistico della regressione lineare</a></li>
<li><a class="" href="inferenza-bayesiana.html"><span class="header-section-number">29</span> Inferenza Bayesiana</a></li>
<li class="book-part">Informazioni generali</li>
<li><a class="" href="citazione.html">Citazione</a></li>
<li class="book-part">Appendici</li>
<li><a class="" href="un-piccolo-ripasso.html">Un piccolo ripasso</a></li>
<li><a class="" href="bibliografia.html">Bibliografia</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="manipolazione-dei-dati" class="section level1" number="8">
<h1>
<span class="header-section-number">Capitolo 8</span> Manipolazione dei dati<a class="anchor" aria-label="anchor" href="#manipolazione-dei-dati"><i class="fas fa-link"></i></a>
</h1>
<div id="motivazione" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Motivazione<a class="anchor" aria-label="anchor" href="#motivazione"><i class="fas fa-link"></i></a>
</h2>
<p>Si chiamano “dati grezzi” quelli che provengono dal mondo circostanze, i
dati raccolti per mezzo degli strumenti usati negli esperimenti, per
mezzo di interviste, di questionari, ecc. Questi dati (chiamati
<em>dataset</em>) raramente vengono forniti con una struttura logica precisa.
Per potere elaborarli mediante dei software dobbiamo prima trasformarli
in maniera tale che abbiano una struttura logica organizzata. La
struttura che solitamente si utilizza è quella tabellare (matrice dei
dati), ovvero si dispongono i dati in una tabella nella quale a ciascuna
riga corrisponde ad un’osservazione e ciascuna colonna corrisponde ad
una variabile rilevata. In <code>R</code> una tale struttura è chiamata <em>data frame</em>.
Il pacchetto <code>dplyr</code>, che è al momento uno dei pacchetti più famosi e
utilizzati per la gestione dei dati, offre una serie di funzionalità che
consentono di ottenere il risultato descritto in precedenza e consente
inoltre di eseguire le operazioni più comuni di manipolazione dei dati
in maniera più semplice rispetto a quanto succeda quando usiamo le
funzioni base di <code>R</code>.</p>
</div>
<div id="trattamento-dei-dati-con-dplyr" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Trattamento dei dati con <code>dplyr</code><a class="anchor" aria-label="anchor" href="#trattamento-dei-dati-con-dplyr"><i class="fas fa-link"></i></a>
</h2>
<p>Il pacchetto <code>dplyr</code> include cinque funzioni base: <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>,
<code>select()</code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code>arrange()</code> e <code>summarise()</code>. A queste cinque
funzioni di base si aggiungono il pipe <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></code> che serve a concatenare più
operazioni e <code>group_by</code> che serve per il subsetting. In particolare,
considerando una matrice osservazioni per variabili, <code>select()</code> e
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> si occupano di organizzare le variabili, <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> e
<code>arrange()</code> i casi, e <code>summarise()</code> i gruppi.</p>
<p>Per introdurre le funzionalità di base di <code>dplyr</code>, considereremo i dati contenuti nel data frame <code>msleep</code> fornito dal pacchetto <code>ggplot2</code>, che elenca le ore di sonno medie per 83 specie di mammiferi <span class="citation">(<a href="bibliografia.html#ref-savage2007scaling" role="doc-biblioref">Savage et al., 2007</a>)</span>. Carichiamo il pacchetto <code>tidyverse</code> (che contiene <code>ggplot2</code>) e leggiamo nella memoria di lavoro l’oggetto <code>msleep</code>:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">msleep</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">msleep</span><span class="op">)</span>
<span class="co">#&gt; [1] 83 11</span></code></pre></div>
<div id="operatore-pipe" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Operatore pipe<a class="anchor" aria-label="anchor" href="#operatore-pipe"><i class="fas fa-link"></i></a>
</h3>
<p>Prima di presentare le funzionalità di <code>tidyverse</code>, introduciamo l’operatore pipe <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></code> del pacchetto <code>magrittr</code> – ma ora presente anche in base <code>R</code> nella versione <code>|&gt;</code>. L’operatore pipe, <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html">%&gt;%</a></code> o <code>|&gt;</code>, serve a concatenare varie funzioni insieme, in modo da inserire un’operazione dietro l’altra. Una spiegazione intuitiva dell’operatore pipe è stata fornita in un tweet di <code>@andrewheiss</code>. Consideriamo la seguente istruzione in pseudo-codice <code>R</code>:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">leave_house</span><span class="op">(</span><span class="fu">get_dressed</span><span class="op">(</span><span class="fu">get_out_of_bed</span><span class="op">(</span><span class="fu">wake_up</span><span class="op">(</span><span class="va">me</span>, time <span class="op">=</span> <span class="st">"8:00"</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"correct"</span><span class="op">)</span>, pants <span class="op">=</span> <span class="cn">TRUE</span>, shirt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, car <span class="op">=</span> <span class="cn">TRUE</span>, bike <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Il listato precedente descrive una serie di (pseudo) funzioni concatenate, le quali costituiscono gli argomenti di altre funzioni. Scritto così, il codice è molto difficile da capire. Possiamo però ottenere lo stesso risultato utilizzando l’operatore pipe che facilita la leggibilità del codice:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">%&gt;%</span> 
  <span class="fu">wake_up</span><span class="op">(</span>time <span class="op">=</span> <span class="st">"8:00"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">get_out_of_bed</span><span class="op">(</span>side <span class="op">=</span> <span class="st">"correct"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">get_dressed</span><span class="op">(</span>pants <span class="op">=</span> <span class="cn">TRUE</span>, shirt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">leave_house</span><span class="op">(</span>car <span class="op">=</span> <span class="cn">TRUE</span>, bike <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>In questa seconda versione del (pseudo) codice <code>R</code> si capisce molto meglio ciò che vogliamo fare. Il data.frame <code>me</code> viene passato alla funzione <code>wake_up()</code>. La funzione <code>wake_up()</code> ha come argomento l’ora del giorno: <code>time = "8:00"</code>. Una volta “svegliati” (wake up) dobbiamo scendere dal letto. Quindi l’output di <code>wake_up()</code> viene passato alla funzione <code>get_out_of_bed()</code> la quale ha come argomento <code>side = "correct"</code> perché vogliamo scendere dal letto dalla parte giusta. E così via.</p>
</div>
<div id="selezionare-le-colonne-del-data.frame-con-select" class="section level3" number="8.2.2">
<h3>
<span class="header-section-number">8.2.2</span> Selezionare le colonne del data.frame con <code>select()</code><a class="anchor" aria-label="anchor" href="#selezionare-le-colonne-del-data.frame-con-select"><i class="fas fa-link"></i></a>
</h3>
<p>Ritorniamo ora all’esempio precedente e supponiamo di volere selezionare le variabili <code>name</code>, <code>vore</code> e <code>sleep_total</code> dal data.frame <code>msleep</code>. Per fare ciò usiamo funzione <code>select()</code> che consente di selezionare un sottoinsieme di variabili in un dataset. Usando pipe scriviamo:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">vore</span>, <span class="va">sleep_total</span><span class="op">)</span>
<span class="va">dt</span>
<span class="co">#&gt; # A tibble: 83 x 3</span>
<span class="co">#&gt;   name                       vore  sleep_total</span>
<span class="co">#&gt;   &lt;chr&gt;                      &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Cheetah                    carni        12.1</span>
<span class="co">#&gt; 2 Owl monkey                 omni         17  </span>
<span class="co">#&gt; 3 Mountain beaver            herbi        14.4</span>
<span class="co">#&gt; 4 Greater short-tailed shrew omni         14.9</span>
<span class="co">#&gt; 5 Cow                        herbi         4  </span>
<span class="co">#&gt; 6 Three-toed sloth           herbi        14.4</span>
<span class="co">#&gt; # … with 77 more rows</span></code></pre></div>
<p>laddove la sequenza di istruzioni precedenti significa che il data.frame <code>dt</code> è stato passato alla funzione <code>select()</code> contenuta nel pacchetto <code>dplyr</code>.</p>
</div>
<div id="filtrare-le-righe-del-data.frame-con-filter" class="section level3" number="8.2.3">
<h3>
<span class="header-section-number">8.2.3</span> Filtrare le righe del data.frame con <code>filter()</code><a class="anchor" aria-label="anchor" href="#filtrare-le-righe-del-data.frame-con-filter"><i class="fas fa-link"></i></a>
</h3>
<p>La funzione <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> consente di selezionare un sottoinsieme di
osservazioni in un dataset. Per esempio, possiamo selezionare tutte le
osservazioni nella variabile <code>vore</code> contrassegnate come <code>carni</code> in
questo modo (ovvero, tutti i carnivori):</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">vore</span> <span class="op">==</span> <span class="st">"carni"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 19 x 3</span>
<span class="co">#&gt;   name                 vore  sleep_total</span>
<span class="co">#&gt;   &lt;chr&gt;                &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Cheetah              carni        12.1</span>
<span class="co">#&gt; 2 Northern fur seal    carni         8.7</span>
<span class="co">#&gt; 3 Dog                  carni        10.1</span>
<span class="co">#&gt; 4 Long-nosed armadillo carni        17.4</span>
<span class="co">#&gt; 5 Domestic cat         carni        12.5</span>
<span class="co">#&gt; 6 Pilot whale          carni         2.7</span>
<span class="co">#&gt; # … with 13 more rows</span></code></pre></div>
</div>
<div id="aggiungere-una-colonna-al-data.frame-con-mutate" class="section level3" number="8.2.4">
<h3>
<span class="header-section-number">8.2.4</span> Aggiungere una colonna al data.frame con <code>mutate()</code><a class="anchor" aria-label="anchor" href="#aggiungere-una-colonna-al-data.frame-con-mutate"><i class="fas fa-link"></i></a>
</h3>
<p>Talvolta vogliamo creare una nuova variabile in uno stesso dataset ad
esempio sommando o dividendo due variabili, oppure calcolandone la
media. A questo scopo si usa la funzione <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>. Per esempio, se
vogliamo esprimere i valori di <code>sleep_total</code> in minuti, moltiplichiamo
per 60:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sleep_minutes <span class="op">=</span> <span class="va">sleep_total</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sleep_total</span>, <span class="va">sleep_minutes</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 83 x 2</span>
<span class="co">#&gt;   sleep_total sleep_minutes</span>
<span class="co">#&gt;         &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1        12.1           726</span>
<span class="co">#&gt; 2        17            1020</span>
<span class="co">#&gt; 3        14.4           864</span>
<span class="co">#&gt; 4        14.9           894</span>
<span class="co">#&gt; 5         4             240</span>
<span class="co">#&gt; 6        14.4           864</span>
<span class="co">#&gt; # … with 77 more rows</span></code></pre></div>
</div>
<div id="ordinare-i-dati-con-arrange" class="section level3" number="8.2.5">
<h3>
<span class="header-section-number">8.2.5</span> Ordinare i dati con <code>arrange()</code><a class="anchor" aria-label="anchor" href="#ordinare-i-dati-con-arrange"><i class="fas fa-link"></i></a>
</h3>
<p>La funzione <code>arrange()</code> serve a ordinare i dati in base ai valori di una
o più variabili. Per esempio, possiamo ordinare la variabile
<code>sleep_total</code> dal valore più alto al più basso in questo modo:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">sleep_total</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 83 x 3</span>
<span class="co">#&gt;   name                   vore    sleep_total</span>
<span class="co">#&gt;   &lt;chr&gt;                  &lt;chr&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Little brown bat       insecti        19.9</span>
<span class="co">#&gt; 2 Big brown bat          insecti        19.7</span>
<span class="co">#&gt; 3 Thick-tailed opposum   carni          19.4</span>
<span class="co">#&gt; 4 Giant armadillo        insecti        18.1</span>
<span class="co">#&gt; 5 North American Opossum omni           18  </span>
<span class="co">#&gt; 6 Long-nosed armadillo   carni          17.4</span>
<span class="co">#&gt; # … with 77 more rows</span></code></pre></div>
</div>
<div id="raggruppare-i-dati-con-group_by" class="section level3" number="8.2.6">
<h3>
<span class="header-section-number">8.2.6</span> Raggruppare i dati con <code>group_by()</code><a class="anchor" aria-label="anchor" href="#raggruppare-i-dati-con-group_by"><i class="fas fa-link"></i></a>
</h3>
<p>La funzione <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> serve a raggruppare insieme i valori in base a
una o più variabili. La vedremo in uso in seguito insieme a
<code>summarise()</code>.</p>
</div>
<div id="sommario-dei-dati-con-summarise" class="section level3" number="8.2.7">
<h3>
<span class="header-section-number">8.2.7</span> Sommario dei dati con <code>summarise()</code><a class="anchor" aria-label="anchor" href="#sommario-dei-dati-con-summarise"><i class="fas fa-link"></i></a>
</h3>
<p>La funzione <code>summarise()</code> collassa il dataset in una singola riga dove
viene riportato il risultato della statistica richiesta. Per esempio, la
media del tempo totale del sonno è</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>
  m_sleep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sleep_total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  m_sleep </span>
<span class="co">#&gt; 10.43373</span></code></pre></div>
</div>
<div id="operazioni-raggruppate" class="section level3" number="8.2.8">
<h3>
<span class="header-section-number">8.2.8</span> Operazioni raggruppate<a class="anchor" aria-label="anchor" href="#operazioni-raggruppate"><i class="fas fa-link"></i></a>
</h3>
<p>In precedenza abbiamo visto come i mammiferi considerati dormano, in
media, 10.4 ore al giorno. Troviamo ora il sonno medio in funzione di
<code>vore</code>:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dt</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>
    m_sleep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sleep_total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, 
    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 x 3</span>
<span class="co">#&gt;   vore    m_sleep     n</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1 carni     10.4     19</span>
<span class="co">#&gt; 2 herbi      9.51    32</span>
<span class="co">#&gt; 3 insecti   14.9      5</span>
<span class="co">#&gt; 4 omni      10.9     20</span>
<span class="co">#&gt; 5 &lt;NA&gt;      10.2      7</span></code></pre></div>
<p>Si noti che, nel caso di 7 osservazioni, il valore di <code>vore</code> non era
specificato. Per tali osservazioni, dunque, la classe di appartenenza è
<code>NA</code>.</p>
</div>
</div>
<div id="dati-categoriali-in-r" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Dati categoriali in <code>R</code><a class="anchor" aria-label="anchor" href="#dati-categoriali-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>Consideriamo una variabile che descrive il genere e include le categorie <code>male</code>, <code>female</code> e <code>non-conforming</code>. In <code>R</code>, ci sono due modi per memorizzare queste informazioni. Uno è usare la classe <em>character strings</em> e l’altro è usare la classe <em>factor</em>. Non ci addentrimo qui nelle sottigliezze di questa distinzione, motivata in gran parte per le necessità della programmazione con le funzioni di <code>tidyverse</code>. Per gli scopi di questo insegnamento sarà sufficiente codificare le variabili qualitative usando la classe <em>factor</em>. Una volta codificati i dati qualitativi utilizzando la classe <em>factor</em>, si pongono spesso due problemi:</p>
<ol style="list-style-type: decimal">
<li>modificare le etichette dei livelli (modalità) di un fattore,</li>
<li>riordinare i livelli di un fattore.</li>
</ol>
<div id="modificare-le-etichette-dei-livelli-di-un-fattore" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> Modificare le etichette dei livelli di un fattore<a class="anchor" aria-label="anchor" href="#modificare-le-etichette-dei-livelli-di-un-fattore"><i class="fas fa-link"></i></a>
</h3>
<p>Esaminiamo l’esempio seguente.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"old_3"</span>, <span class="st">"old_4"</span>, <span class="st">"old_1"</span>, <span class="st">"old_1"</span>, <span class="st">"old_2"</span><span class="op">)</span>
<span class="va">f_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">f_1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">f_1</span>, <span class="va">y</span><span class="op">)</span>
<span class="va">df</span>
<span class="co">#&gt;     f_1 y</span>
<span class="co">#&gt; 1 old_3 1</span>
<span class="co">#&gt; 2 old_4 2</span>
<span class="co">#&gt; 3 old_1 3</span>
<span class="co">#&gt; 4 old_1 4</span>
<span class="co">#&gt; 5 old_2 5</span></code></pre></div>
<p>Supponiamo di volere che i livelli del fattore <code>f_1</code> abbiano le etichette <code>new_1</code>, <code>new_2</code>, ecc. Per ottenere questo risultato usiamo la funzione <code><a href="https://rdrr.io/pkg/car/man/recode.html">recode()</a></code> di <code>dplyr</code>:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>f_1 <span class="op">=</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">f_1</span>,
      <span class="st">"old_1"</span> <span class="op">=</span> <span class="st">"new_poco"</span>,
      <span class="st">"old_2"</span> <span class="op">=</span> <span class="st">"new_medio"</span>,
      <span class="st">"old_3"</span> <span class="op">=</span> <span class="st">"new_tanto"</span>,
      <span class="st">"old_4"</span> <span class="op">=</span> <span class="st">"new_massimo"</span>,
     <span class="op">)</span>
   <span class="op">)</span>
<span class="va">df</span>
<span class="co">#&gt;           f_1 y</span>
<span class="co">#&gt; 1   new_tanto 1</span>
<span class="co">#&gt; 2 new_massimo 2</span>
<span class="co">#&gt; 3    new_poco 3</span>
<span class="co">#&gt; 4    new_poco 4</span>
<span class="co">#&gt; 5   new_medio 5</span></code></pre></div>
</div>
<div id="riordinare-i-livelli-di-un-fattore" class="section level3" number="8.3.2">
<h3>
<span class="header-section-number">8.3.2</span> Riordinare i livelli di un fattore<a class="anchor" aria-label="anchor" href="#riordinare-i-livelli-di-un-fattore"><i class="fas fa-link"></i></a>
</h3>
<p>Spesso i livelli dei fattori hanno un ordinamento naturale. Tuttavia, l’impostazione predefinita in base <code>R</code> è ordinare i livelli in ordine alfabetico. Quindi, gli utenti devono avere un modo per imporre l’ordine desiderato sulla codifica delle loro variabili qualitative. Ciò può essere ottenuto nel modo seguente.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">f_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">f_1</span>,
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"new_poco"</span>, <span class="st">"new_medio"</span>, <span class="st">"new_tanto"</span>, <span class="st">"new_massimo"</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">f_1</span><span class="op">)</span>
<span class="co">#&gt;    new_poco   new_medio   new_tanto new_massimo </span>
<span class="co">#&gt;           2           1           1           1</span></code></pre></div>
<p>Per approfondire le problematiche della manipolazione di variabili qualitative in R, si veda <span class="citation">(<a href="#ref-mcnamara2018wrangling" role="doc-biblioref"><strong>mcnamara2018wrangling?</strong></a>)</span>.</p>
</div>
</div>
<div id="creare-grafici-con-ggplot2" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Creare grafici con <code>ggplot2()</code><a class="anchor" aria-label="anchor" href="#creare-grafici-con-ggplot2"><i class="fas fa-link"></i></a>
</h2>
<p>Il pacchetto <code><a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html">ggplot2()</a></code> è un potente strumento per rappresentare graficamente i dati. Le iniziali del nome, <code>gg</code>, si riferiscono alla “Grammar of Graphics,” che è un modo di pensare le figure come una serie di layer stratificati. Originariamente descritta da <span class="citation">(<a href="#ref-wilkinson2012grammar" role="doc-biblioref"><strong>wilkinson2012grammar?</strong></a>)</span>, la grammatica dei grafici è stata aggiornata e applicata in R da Hadley Wickham, il creatore del pacchetto.</p>
<p>La funzione da cui si parte per inizializzare un grafico è <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. La funzione <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> richiede due argomenti. Il primo è l’oggetto di tipo data.frame che contiene i dati da visualizzare – in alternativa al primo argomento, un dataframe può essere passato a <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> mediante l’operatore pipe. Il secondo è una particolare lista che viene generata dalla funzione <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, la quale determina l’aspetto (<em>aesthetic</em>) del grafico. La funzione <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> richiede necessariamente di specificare “x” e “y,” ovvero i nomi delle colonne del data.frame che è stato utilizzato quale primo argomento di <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> (o che è stato passato da pipe), le quali rappresentano le variabili da porre rispettivamente sugli assi orizzontale e verticale.</p>
<p>La definizione della tipologia di grafico e i vari parametri sono poi definiti successivamente, aggiungendo all’oggetto creato da <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> tutte le componenti necessarie. Saranno quindi altre funzioni, come <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> o <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> a occuparsi di aggiungere al livello di base barre, linee, punti, e così via. Infine, tramite altre funzioni, ad esempio <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>, sarà possibile definire i dettagli più fini.</p>
<p>Gli elementi grafici (bare, punti, segmenti, …) usati da <code>ggplot2</code> sono chiamati <code>geoms</code>. Mediante queste funzioni è possibile costruire diverse tipologie di grafici:</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>: crea un layer con delle barre;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>: crea un layer con dei punti (diagramma a dispersione);</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>: crea un layer con una linea retta;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>: crea un layer con un istogramma;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>: crea un layer con un box-plot;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar()</a></code>: crea un layer con barre che rappresentano intervalli di confidenza;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline()</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline()</a></code> : crea un layer con una linea orizzontale o verticale definita dall’utente.</p></li>
</ul>
<p>Un comando generico ha la seguente forma:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_graph</span> <span class="op">&lt;-</span> <span class="va">my_data</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x_var</span>, <span class="va">y_var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_...</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>La prima volta che si usa il pacchetto <code>ggplot2</code> è necessario installarlo. Per fare questo possiamo installare <code>tidyverse</code> che, oltre a caricare <code>ggplot2</code>, carica anche altre utili funzioni per l’analisi dei dati:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></code></pre></div>
<p>Per attivare il pacchetto si usa l’istruzione:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></code></pre></div>
<p>Ogni volta che si inizia una sessione R è necessario attivare i pacchetti che si vogliono usare, ma non è necessario istallarli una nuova volta. Se è necessario specificare il pacchetto nel quale è contenuta la funzione (o il data.frame) che vogliamo utilizzare, usiamo la sintassi <code>package::function()</code>. Per esempio, l’istruzione <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code> rende esplicito che stiamo usando la funzione <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> contenuta nel pacchetto <code>ggplot2</code>.</p>
<div id="diagramma-a-dispersione" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> Diagramma a dispersione<a class="anchor" aria-label="anchor" href="#diagramma-a-dispersione"><i class="fas fa-link"></i></a>
</h3>
<p>Consideriamo nuovamenti i dati contenuti nel data frame <code>msleep</code> e poniamoci il problema di rappresentare graficamente la relazione tra il numero medio di ore di sonno giornaliero (<code>sleep_total</code>) e il peso dell’animale (<code>bodywt</code>). Usando le impostazioni di default di <code>ggplot2</code>, con le istruzioni seguenti, otteniamo il grafico fornito dalla figura seguente.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">msleep</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bodywt</span>, y <span class="op">=</span> <span class="va">sleep_total</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Data-Science-per-psicologi_files/figure-html/unnamed-chunk-117-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Coloriamo ora in maniera diversa i punti che rappresentano animali carnivori, erbivori, ecc.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bodywt</span>, y <span class="op">=</span> <span class="va">sleep_total</span>, col <span class="op">=</span> <span class="va">vore</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Data-Science-per-psicologi_files/figure-html/unnamed-chunk-118-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>È chiaro, senza fare alcuna analisi statistica, che la relazione tra le due variabili non è lineare. Trasformando in maniera logaritmica i valori dell’asse <span class="math inline">\(x\)</span> la relazione si linearizza.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">msleep</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">sleep_total</span>, col <span class="op">=</span> <span class="va">vore</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Data-Science-per-psicologi_files/figure-html/unnamed-chunk-119-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Infine, aggiustiamo il “tema” del grafico, aggiungiamo le etichette sugli assi e il titolo.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msleep</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">sleep_total</span>, col <span class="op">=</span> <span class="va">vore</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="st">"Log Peso Corporeo"</span>,
      y <span class="op">=</span> <span class="st">"Totale Ore di Sonno"</span>,
      title <span class="op">=</span> <span class="st">"Il sonno in 83 specie di mammiferi"</span>,
      subtitle <span class="op">=</span> <span class="st">"Savage e West (2007)"</span>
     <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Data-Science-per-psicologi_files/figure-html/unnamed-chunk-120-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="istogramma" class="section level3" number="8.4.2">
<h3>
<span class="header-section-number">8.4.2</span> Istogramma<a class="anchor" aria-label="anchor" href="#istogramma"><i class="fas fa-link"></i></a>
</h3>
<p>Creiamo ora un istogramma che rappresenta la distribuzione del (logaritmo del) peso medio del cervello delle 83 specie di mammiferi considerate da <span class="citation">(<a href="#ref-savage2007quantitative" role="doc-biblioref"><strong>savage2007quantitative?</strong></a>)</span>.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msleep</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">brainwt</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Log Peso Cervello"</span>,
    y <span class="op">=</span> <span class="st">"Frequenza Relativa"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; Warning: Removed 27 rows containing non-finite values (stat_bin).</span></code></pre></div>
<div class="inline-figure"><img src="Data-Science-per-psicologi_files/figure-html/unnamed-chunk-121-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>L’argomento <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes(y=..density..)</a></code> in <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> produce le frequenze relative. L’opzione di default (senza questo argomento) porta <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> a rappresentare le frequenze assolute.</p>
</div>
<div id="scrivere-il-codice-in-r-con-stile" class="section level3" number="8.4.3">
<h3>
<span class="header-section-number">8.4.3</span> Scrivere il codice in <code>R</code> con stile<a class="anchor" aria-label="anchor" href="#scrivere-il-codice-in-r-con-stile"><i class="fas fa-link"></i></a>
</h3>
<p>Uno stile di programmazione è un insieme di regole per la gestione dell’indentazione dei blocchi di codice, per la creazione dei nomi dei file e delle variabili e per le convenzioni tipografiche che vengono usate. Scrivere il codice in <code>R</code> con stile consente di creare listati più leggibili e semplici da modificare, minimizza la possibilità di errore, e consente correzioni e modifiche più rapide. Vi sono molteplici stili di programmazione che possono essere utilizzati dall’utente, anche se è bene attenersi a quelle che sono le convenzioni maggiormente diffuse, allo scopo di favorire la comunicazione. In ogni caso, l’importante è di essere coerenti, ovvero di adottare le stesse convenzioni in tutte le parti del codice che si scrive. Ad esempio, se si sceglie di usare lo stile <code>snake_case</code> per il nome composto di una variabile (es., <code>personality_trait</code>), non è appropriato usare lo stile <em>lower Camel case</em> per un’altra variabile (es., <code>socialStatus</code>). Dato che questo argomento è stato trattato ampiamente in varie sedi, mi limito qui a rimandare ad uno stile di programmazione molto popolare, quello proposto da Hadley Wickham, il creatore di <code>tidyverse</code>. Potete trovare maggiori informazioni al seguente link: <a href="http://style.tidyverse.org/" class="uri">http://style.tidyverse.org/</a>.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="chapter-input-output.html"><span class="header-section-number">7</span> Input/Output</a></div>
<div class="next"><a href="flusso-di-lavoro-riproducibile.html"><span class="header-section-number">9</span> Flusso di lavoro riproducibile</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#manipolazione-dei-dati"><span class="header-section-number">8</span> Manipolazione dei dati</a></li>
<li><a class="nav-link" href="#motivazione"><span class="header-section-number">8.1</span> Motivazione</a></li>
<li>
<a class="nav-link" href="#trattamento-dei-dati-con-dplyr"><span class="header-section-number">8.2</span> Trattamento dei dati con dplyr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#operatore-pipe"><span class="header-section-number">8.2.1</span> Operatore pipe</a></li>
<li><a class="nav-link" href="#selezionare-le-colonne-del-data.frame-con-select"><span class="header-section-number">8.2.2</span> Selezionare le colonne del data.frame con select()</a></li>
<li><a class="nav-link" href="#filtrare-le-righe-del-data.frame-con-filter"><span class="header-section-number">8.2.3</span> Filtrare le righe del data.frame con filter()</a></li>
<li><a class="nav-link" href="#aggiungere-una-colonna-al-data.frame-con-mutate"><span class="header-section-number">8.2.4</span> Aggiungere una colonna al data.frame con mutate()</a></li>
<li><a class="nav-link" href="#ordinare-i-dati-con-arrange"><span class="header-section-number">8.2.5</span> Ordinare i dati con arrange()</a></li>
<li><a class="nav-link" href="#raggruppare-i-dati-con-group_by"><span class="header-section-number">8.2.6</span> Raggruppare i dati con group_by()</a></li>
<li><a class="nav-link" href="#sommario-dei-dati-con-summarise"><span class="header-section-number">8.2.7</span> Sommario dei dati con summarise()</a></li>
<li><a class="nav-link" href="#operazioni-raggruppate"><span class="header-section-number">8.2.8</span> Operazioni raggruppate</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dati-categoriali-in-r"><span class="header-section-number">8.3</span> Dati categoriali in R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#modificare-le-etichette-dei-livelli-di-un-fattore"><span class="header-section-number">8.3.1</span> Modificare le etichette dei livelli di un fattore</a></li>
<li><a class="nav-link" href="#riordinare-i-livelli-di-un-fattore"><span class="header-section-number">8.3.2</span> Riordinare i livelli di un fattore</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#creare-grafici-con-ggplot2"><span class="header-section-number">8.4</span> Creare grafici con ggplot2()</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#diagramma-a-dispersione"><span class="header-section-number">8.4.1</span> Diagramma a dispersione</a></li>
<li><a class="nav-link" href="#istogramma"><span class="header-section-number">8.4.2</span> Istogramma</a></li>
<li><a class="nav-link" href="#scrivere-il-codice-in-r-con-stile"><span class="header-section-number">8.4.3</span> Scrivere il codice in R con stile</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Science per psicologi</strong>" was written by Corrado Caudek. It was last built on 2021-04-29 11:45:34.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
